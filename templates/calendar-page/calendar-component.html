

<div class="calendar-table-div">
  <table id="calendar-table" class="table table-bordered">

    <!-- table column names -->
    <thead>
      <tr class="calendar-row">
        {% for col_name in calendar.column_names %}
          <th class="calendar-data">
            <span>{{ col_name }}</span>
          </th>
        {% endfor %}
      </tr>
    </thead>

    <!-- table cells -->
    <tbody>
      {% for row_key in calendar.row_keys %}

        <!-- displayed between rows to be able to insert additional rows -->
        {% if user_owns_calendar %}
          <tr class="add-a-row-row">
            <td id="{{ row_key.urlsafe() }}"
                colspan="{{ calendar.column_names|length }}"
                class="add-a-row-div calendar-clickable">
              +
            </td>
          </tr>
        {% endif %}

        <tr>

          <td id="{{ row_key.get().date_cell.urlsafe() }}"
              class="calendar-cell date-cell">
            {{ row_key.get().date_cell.get().date.strftime(date_format) }}
          </td>

          {% for cell_key in row_key.get().cell_keys %}
            <td id="{{cell_key.urlsafe()}}"
                class="{% if user_owns_calendar %}calendar-clickable {% endif %}calendar-cell">

              <!-- hidden divs to make editting more pleasant -->
              <div class="hidden-markdown hidden">{{ cell_key.get().text }}</div>
              {% if user_owns_calendar %}
                <div class="hidden-markdown-edits hidden">{{ cell_key.get().text }}</div>
              {% endif %}

              <!-- the visible markdown -->
              <div class="visible-text"></div>
            </td>
          {% endfor %}
        </tr>
      {% endfor %}

      <!-- add a row at the very end -->
      {% if user_owns_calendar %}
        <tr class="add-a-row-row">
          <td colspan="{{ calendar.column_names|length }}">
            <div id="last-row" class="add-a-row-div calendar-clickable">+</div>
          </td>
        </tr>
      {% endif %}
    </tbody>

  </table>

</div>
